'''
import libraries
'''
from mpi4py import MPI
import json
import math
import sys


def get_FileName(argv):
    if len(argv) > 1:
        return argv[1]
    else:
        return "bigTwitter.json"


# load the grid data, specifically the coordinates of vetices
# of each grid box
def get_Grid(gridFile):
    with open(gridFile, 'r') as melbGrid:
        gridData = json.load(melbGrid)
        grid = []
        for box in gridData["features"]:
            grid.append(box["properties"])
    return grid


# count the total number of data records in a json lines file
def count_lines(tweet_file):
    count = 0
    for line in tweet_file:
        count += 1
    return count


def data_partition(comm, data_file, file_lines):
    pass


def master_process(comm, grid, argv):
    with open(argv[1], 'r') as data_File:
        file_lines = count_lines(data_File)
        data_partition(comm, grid, data_File, file_lines)


def slave_process():
    pass


# Decide which grid box a given point with its x, y coordinates belongs to
def which_grid_box(cor_x, cor_y, grid):
    for box in grid:
        if cor_x >= box["xmin"] and cor_x <= box["xmax"] \
         and cor_y >= box["ymin"] and cor_y <= box["ymin"]:
            area = box["id"]
    return area


def main(argv):
    comm = MPI.COMM_WORLD
    # Get rank of process
    rank = comm.Get_rank()
    processes = comm.Get_size()
    grid = get_Grid(argv[0])  # suppose argv == "melbGrid.json"
    if processes < 2:
        #to be continue
        pass
    else:
        pass


if __name__ == "__main__":
    main(sys.argv)
